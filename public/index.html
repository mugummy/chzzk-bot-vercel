<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chzzk Bot Dashboard</title>
    <script src="config.js"></script>
    <script src="api-adapter.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="vote-ui-enhanced.css">
    <style>
        /* Landing Page Styles */
        .landing-page {
            position: fixed;
            inset: 0;
            background: #000;
            background-image: radial-gradient(circle at 50% 50%, #1a1a2e 0%, #000 100%);
            z-index: 2000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }
        .landing-page.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }
        .landing-logo {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, #00ff94, #00d4ff);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            color: #000;
            margin-bottom: 30px;
            box-shadow: 0 0 40px rgba(0, 255, 148, 0.3);
            animation: float 6s ease-in-out infinite;
        }
        .landing-title {
            font-size: 48px;
            font-weight: 800;
            margin-bottom: 16px;
            color: #fff;
        }
        .landing-desc {
            font-size: 18px;
            color: #aaa;
            margin-bottom: 40px;
            max-width: 600px;
            line-height: 1.6;
        }
        .landing-btn {
            padding: 16px 48px;
            font-size: 18px;
            font-weight: 600;
            background: #00ff94;
            color: #000;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(0, 255, 148, 0.4);
        }
        .landing-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(0, 255, 148, 0.5);
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
    </style>
</head>
<body>
    <!-- Landing Page -->
    <div id="landing-page" class="landing-page">
        <div class="landing-logo">
            <i class="fas fa-robot"></i>
        </div>
        <h1 class="landing-title">치지직 봇 대시보드</h1>
        <p class="landing-desc">
            방송 관리를 위한 최고의 파트너<br>
            명령어, 투표, 룰렛, 시청자 참여까지 한 번에.
        </p>
        <button class="landing-btn" onclick="window.showLoginOverlay()">시작하기</button>
    </div>

    <!-- Login Overlay -->
    <div id="login-overlay" class="modal-overlay">
        <div class="login-card">
            <h2 class="login-title">로그인</h2>
            <p class="login-subtitle">네이버 계정으로 연동합니다.</p>
            
            <div id="login-error" style="display:none; color: #ff4757; background: rgba(255,71,87,0.1); padding: 10px; border-radius: 8px; margin-bottom: 20px; font-size: 13px;">
                <i class="fas fa-exclamation-circle"></i> <span id="login-error-text">오류 발생</span>
            </div>

            <a href="/auth/login" class="oauth-btn">
                네이버로 로그인
            </a>
            
            <button onclick="window.hideLoginOverlay()" class="btn btn-secondary mt-2" style="width: 100%; margin-top: 15px;">
                취소
            </button>
        </div>
    </div>

    <!-- App Container -->
    <div id="app-container" class="app-container hidden">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                CHZZK BOT
            </div>
            
            <div class="sidebar-profile" id="sidebar-profile" style="padding: 20px; display: flex; align-items: center; border-bottom: 1px solid #333;">
                <div id="sidebar-avatar" style="width: 40px; height: 40px; border-radius: 50%; background-color: #555; background-size: cover; margin-right: 10px;"></div>
                <div id="sidebar-name" style="font-weight: bold;">로딩중...</div>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-item active" data-tab="dashboard">
                    <i class="fas fa-home"></i> 대시보드
                </div>
                <div class="nav-item" data-tab="commands">
                    <i class="fas fa-terminal"></i> 명령어
                </div>
                <div class="nav-item" data-tab="macros">
                    <i class="fas fa-clock"></i> 매크로
                </div>
                <div class="nav-item" data-tab="counters">
                    <i class="fas fa-calculator"></i> 카운터
                </div>
                <div class="nav-item" data-tab="songs">
                    <i class="fas fa-music"></i> 신청곡
                </div>
                <div class="nav-item" data-tab="votes">
                    <i class="fas fa-poll"></i> 투표/추첨
                </div>
                <div class="nav-item" data-tab="participation">
                    <i class="fas fa-users"></i> 시청자 참여
                </div>
                <div class="nav-item" data-tab="points">
                    <i class="fas fa-coins"></i> 포인트
                </div>
            </nav>
            
            <div class="sidebar-footer">
                <div class="bot-status" style="margin-bottom: 15px;">
                    <div class="status-indicator" id="bot-status-indicator"></div>
                    <span id="bot-status-text">봇 미연결</span>
                </div>
                <button id="logout-btn" class="btn btn-secondary" style="width: 100%;">
                    로그아웃
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="header">
                <div class="header-title" id="header-title">대시보드</div>
                <div class="header-right">
                    <div class="header-profile-info" style="display: flex; align-items: center;">
                        <div id="header-avatar" style="width: 32px; height: 32px; border-radius: 50%; background-color: #555; background-size: cover; margin-right: 10px;"></div>
                        <span id="header-username"></span>
                    </div>
                </div>
            </header>

            <div class="content-area">
                <!-- Dashboard Tab -->
                <div id="dashboard-tab" class="tab-content active">
                    <div class="dashboard-grid">
                        <div class="card channel-card">
                            <div class="channel-info">
                                <div class="channel-avatar" id="channel-avatar"></div>
                                <div class="channel-details">
                                    <h2 id="channel-name">채널명</h2>
                                    <div class="channel-stats" id="follower-count">팔로워: -</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card stats-card">
                            <div class="card-title"><i class="fas fa-chart-line"></i> 통계</div>
                            <div class="stats-grid">
                                <div class="stat-item">
                                    <div class="stat-value" id="stat-commands">0</div>
                                    <div class="stat-label">명령어</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="stat-songs">0</div>
                                    <div class="stat-label">신청곡</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="stat-votes">0</div>
                                    <div class="stat-label">투표</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="stat-participants">0</div>
                                    <div class="stat-label">참여자</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card chat-card" style="grid-column: span 2;">
                            <div class="card-title">
                                <span><i class="fas fa-comments"></i> 실시간 채팅</span>
                            </div>
                            <div class="chat-messages" id="chat-messages">
                                <div class="chat-empty">
                                    <p>채팅 대기 중...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Commands Tab -->
                <div id="commands-tab" class="tab-content">
                    <div class="card">
                        <div class="card-title" style="display: flex; justify-content: space-between;">
                            명령어 목록
                            <button class="btn btn-primary" onclick="showModal('add-command-modal')">추가</button>
                        </div>
                        <div class="item-list" id="commands-list"></div>
                    </div>
                </div>

                <!-- Macros Tab -->
                <div id="macros-tab" class="tab-content">
                    <div class="card">
                        <div class="card-title" style="display: flex; justify-content: space-between;">
                            매크로 목록
                            <button class="btn btn-primary" onclick="showModal('add-macro-modal')">추가</button>
                        </div>
                        <div class="item-list" id="macros-list"></div>
                    </div>
                </div>

                <!-- Counters Tab -->
                <div id="counters-tab" class="tab-content">
                    <div class="card">
                        <div class="card-title" style="display: flex; justify-content: space-between;">
                            카운터 목록
                            <button class="btn btn-primary" onclick="showModal('add-counter-modal')">추가</button>
                        </div>
                        <div class="item-list" id="counters-list"></div>
                    </div>
                </div>
                
                <!-- Songs Tab -->
                <div id="songs-tab" class="tab-content">
                    <div class="dashboard-grid">
                        <div class="card">
                            <div class="card-title">현재 재생</div>
                            <div id="current-song" class="text-center" style="padding: 20px;">재생 중인 곡 없음</div>
                            <div class="player-controls mt-2" style="display: flex; justify-content: center; gap: 10px;">
                                <button id="play-pause-btn" class="btn btn-primary"><i class="fas fa-play"></i></button>
                                <button id="skip-btn" class="btn btn-secondary"><i class="fas fa-forward"></i></button>
                                <button id="stop-song-btn" class="btn btn-danger"><i class="fas fa-stop"></i></button>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-title">대기열 (<span id="queue-count">0</span>)</div>
                            <div id="song-queue-list" class="item-list"></div>
                        </div>
                    </div>
                </div>

                <!-- Votes Tab Placeholder -->
                <div id="votes-tab" class="tab-content">
                    <!-- Content injected by vote-system.js -->
                </div>

                <!-- Participation Tab -->
                <div id="participation-tab" class="tab-content">
                    <div class="card">
                        <div class="card-title" style="display: flex; justify-content: space-between;">
                            시청자 참여 관리
                            <div>
                                <button class="btn btn-primary" id="toggle-participation-btn">시작</button>
                                <button class="btn btn-secondary" id="clear-participation-btn">초기화</button>
                            </div>
                        </div>
                        <div class="participation-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                            <div class="list-column">
                                <h4 style="margin-bottom: 10px;">대기열 (<span id="waiting-count">0</span>)</h4>
                                <div id="waiting-queue" class="item-list" style="min-height: 200px; background: rgba(255,255,255,0.05); border-radius: 8px; padding: 10px;"></div>
                            </div>
                            <div class="list-column">
                                <h4 style="margin-bottom: 10px;">참여중 (<span id="active-count">0</span>)</h4>
                                <div id="active-participants" class="item-list" style="min-height: 200px; background: rgba(255,255,255,0.05); border-radius: 8px; padding: 10px;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Points Tab -->
                <div id="points-tab" class="tab-content">
                    <div class="dashboard-grid">
                        <div class="card">
                            <div class="card-title">포인트 설정</div>
                            <div class="form-group">
                                <label>채팅당 포인트</label>
                                <input type="number" id="points-per-chat" class="form-input">
                            </div>
                            <button id="save-points-settings" class="btn btn-primary">저장</button>
                        </div>
                        <div class="card">
                            <div class="card-title">포인트 랭킹</div>
                            <div id="points-ranking" class="item-list"></div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <div id="add-command-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2>명령어 추가</h2>
                <button class="modal-close" onclick="hideModal('add-command-modal')">×</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>명령어</label>
                    <input type="text" class="form-input" id="new-command-trigger" placeholder="!명령어">
                </div>
                <div class="form-group">
                    <label>응답</label>
                    <textarea class="form-textarea" id="new-command-response" placeholder="응답 내용"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="hideModal('add-command-modal')">취소</button>
                <button class="btn btn-primary" onclick="addCommand()">저장</button>
            </div>
        </div>
    </div>
    
    <!-- Add Macro Modal -->
    <div id="add-macro-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2>매크로 추가</h2>
                <button class="modal-close" onclick="hideModal('add-macro-modal')">×</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>간격 (분)</label>
                    <input type="number" class="form-input" id="new-macro-interval" value="10">
                </div>
                <div class="form-group">
                    <label>메시지</label>
                    <textarea class="form-textarea" id="new-macro-message" placeholder="매크로 메시지"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="hideModal('add-macro-modal')">취소</button>
                <button class="btn btn-primary" onclick="addMacro()">저장</button>
            </div>
        </div>
    </div>

    <!-- Add Counter Modal -->
    <div id="add-counter-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2>카운터 추가</h2>
                <button class="modal-close" onclick="hideModal('add-counter-modal')">×</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>명령어</label>
                    <input type="text" class="form-input" id="new-counter-trigger" placeholder="!카운터">
                </div>
                <div class="form-group">
                    <label>응답 포맷</label>
                    <textarea class="form-textarea" id="new-counter-response" placeholder="{count}회 발생했습니다."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="hideModal('add-counter-modal')">취소</button>
                <button class="btn btn-primary" onclick="addCounter()">저장</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // Global UI functions
        window.showLoginOverlay = function() {
            document.getElementById('landing-page').classList.add('hidden');
            const overlay = document.getElementById('login-overlay');
            overlay.classList.remove('hidden');
            overlay.classList.add('show');
        };
        
        window.hideLoginOverlay = function() {
            document.getElementById('landing-page').classList.remove('hidden');
            const overlay = document.getElementById('login-overlay');
            overlay.classList.remove('show');
            setTimeout(() => overlay.classList.add('hidden'), 300);
        };
    </script>
    <script src="dashboard.js"></script>
    <script src="vote-system.js"></script>
</body>
</html>
